<dialog id="modal_exercise" class="modal">
  <div class="modal-box w-11/12 max-w-5xl max-h-[90vh]">
    <form method="dialog">
      <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">
        <i class="material-icons-outlined !text-xl">close</i>
      </button>
    </form>

    <h2 class="text-lg font-semibold mb-4">{{ title() }}</h2>

    <form [formGroup]="exerciseForm" (ngSubmit)="onSubmit()" class="space-y-4">
      <!-- Category & Difficulty -->
      <div class="flex flex-col sm:flex-row gap-4">
        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Categoría</legend>
          <select
            class="select validator w-full"
            formControlName="category"
            required
          >
            <option value="" disabled>Seleccione</option>
            @for (category of categories(); track category) {
              <option [value]="category.id">
                {{ category.localizedName["es"] || "Unknown" }}
              </option>
            }
          </select>
          <p class="validator-hint hidden">
            Por favor seleccione una categoría
          </p>
        </fieldset>

        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Dificultad</legend>
          <select
            class="select validator w-full"
            formControlName="difficulty"
            required
          >
            @for (type of Object.values(ExerciseDifficultyType); track type) {
              <option [value]="type">{{ type }}</option>
            }
          </select>
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "difficulty") }}
          </p>
        </fieldset>
      </div>

      <!-- Titles -->
      <div class="flex flex-col sm:flex-row gap-4">
        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Título</legend>
          <input
            type="text"
            class="input validator w-full"
            formControlName="title"
            placeholder="Título"
            required
            autocomplete="off"
          />
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "title") }}
          </p>
        </fieldset>

        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Título en Inglés</legend>
          <input
            type="text"
            class="input validator w-full"
            formControlName="titleEn"
            placeholder="Título en Inglés"
            required
            autocomplete="off"
          />
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "titleEn") }}
          </p>
        </fieldset>
      </div>

      <!-- Descriptions -->
      <div class="flex flex-col sm:flex-row gap-4">
        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Descripción</legend>
          <textarea
            class="textarea validator w-full"
            formControlName="description"
            placeholder="Descripción"
            required
            autocomplete="off"
          ></textarea>
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "description") }}
          </p>
        </fieldset>

        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Descripción en Inglés</legend>
          <textarea
            class="textarea validator w-full"
            formControlName="descriptionEn"
            placeholder="Descripción en inglés"
            required
            autocomplete="off"
          ></textarea>
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "descriptionEn") }}
          </p>
        </fieldset>
      </div>

      <!-- Content Type & Duration -->
      <div class="flex flex-col sm:flex-row gap-4">
        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Tipo de contenido</legend>
          <select
            class="select validator w-full"
            formControlName="contentType"
            required
          >
            @for (type of Object.values(ExerciseContentType); track type) {
              <option [value]="type">{{ type }}</option>
            }
          </select>
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "contentType") }}
          </p>
        </fieldset>

        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Duración (minutos)</legend>
          <input
            type="number"
            class="input validator w-full"
            formControlName="duration"
            placeholder="0"
            min="0"
            autocomplete="off"
          />
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "duration") }}
          </p>
        </fieldset>
      </div>

      <!-- URLs -->
      <div class="flex flex-col sm:flex-row gap-4">
        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Url del contenido</legend>
          <input
            type="url"
            class="input validator w-full"
            formControlName="contentUrl"
            placeholder="Url del contenido"
            autocomplete="off"
          />
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "contentUrl") }}
          </p>
        </fieldset>

        <fieldset class="fieldset w-full">
          <legend class="fieldset-legend">Url del thumbnail</legend>
          <input
            type="url"
            class="input validator w-full"
            formControlName="thumbnailUrl"
            placeholder="Url del thumbnail"
            autocomplete="off"
          />
          <p class="validator-hint hidden">
            {{ FormUtils.getFieldError(exerciseForm, "thumbnailUrl") }}
          </p>
        </fieldset>
      </div>

      <!-- Content -->
      <fieldset class="fieldset">
        <legend class="fieldset-legend">Contenido</legend>
        <textarea
          class="textarea validator w-full h-24"
          formControlName="content"
          placeholder="Contenido"
          autocomplete="off"
        ></textarea>
        <p class="validator-hint hidden">
          {{ FormUtils.getFieldError(exerciseForm, "content") }}
        </p>
      </fieldset>

      <fieldset class="fieldset">
        <legend class="fieldset-legend">Contenido en Inglés</legend>
        <textarea
          class="textarea validator w-full h-24"
          formControlName="contentEn"
          placeholder="Contenido en inglés"
          autocomplete="off"
        ></textarea>
        <p class="validator-hint hidden">
          {{ FormUtils.getFieldError(exerciseForm, "contentEn") }}
        </p>
      </fieldset>

      <div class="modal-action mt-6">
        <form method="dialog" class="space-x-2">
          <button class="btn">Cerrar</button>

          <button
            class="btn btn-primary"
            [disabled]="exerciseForm.invalid"
            (click)="onSubmit()"
            type="submit"
          >
            {{ nameButton() }}
          </button>
        </form>
      </div>
    </form>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>
